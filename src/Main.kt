import geojson.*

fun main() {
    val code1 = """
    location "Mango" restaurant 0.0 {
        for (let x = 1 to 10 ) {
            console x
        }
        
        let f = 10
        if (f > 9) {
            box ((0, 0), (1, 1))
        } else {   
            bend ((0, 0), (1, 1), 0.01)
        }

        line ((0, 0), (1, 1))
        circle ((0, 0), 0.5)
        point ((1, 1))
    }
    for (let x = 1 to 10 ) {
            console x
        }
        
        let f = 10
        if (f > 9) {
            box ((0, 0), (1, 1))
        } else {   
            bend ((0, 0), (1, 1), 0.01)
        }
    """.trimIndent()

    val code2 = """
        line ((0, 0), (1, 1))
        circle ((0, 0), 0.5)
        point ((1, 1))
    """.trimIndent()

    val code3 = """
        let f = 10
        if (f > 9) {
            for (let hmm = 1 to 4) {
                console hmm
                if (hmm > 2) {
                    console hmm
                }
            }
        } else {
            console 2
        }
    """.trimIndent()

    val code4 = """
        fun "hmmmm"(a, b) {
            console a
            console (b + a)
        }
    """.trimIndent()

    val code5 = """
        setSpent "hmmm" 30
    """.trimIndent()

    val code6 = """
        let a = 6
        
        console (a + a)
        console 4
    """.trimIndent()

    val code7 = """
        building "Nakupovalni Center neki" {
            line ((15.630171375091635 , 46.56293656232654) , (15.630308095821704 , 46.56324433124206))
            line ((15.630094452606698 , 46.56329781931049) , (15.630128326559088 , 46.563376067034966))
            line ((15.629344427349565 , 46.56355122857943) , (15.629419576845777 , 46.563716046498115))
            line ((15.62871228680865 , 46.56391684878852) , (15.628326537629164 , 46.5633713978915))
            point ((15.630171375091635 , 46.56293656232654))
        }
    
        location "Restavracija Mango" restaurant 0.0 {
            set_spent "Restavracija Mango" 100.00
            point ((15.629524995443461 , 46.56312748746055))
        }
    
        building "Commercial_2" {
            line ((15.62857163132253 , 46.56327009050841) , (15.628493111378674 , 46.56311194118203))
            line ((15.629045082669421 , 46.56297659402006) , (15.62912230860519 , 46.563141950036766))
            point ((15.62857163132253 , 46.56327009050841))
        }
    
        building "Commercial_3" {
            line ((15.629184313491862 , 46.56313108435387) , (15.629095150342437 , 46.562967671521704))
            line ((15.629894950420805 , 46.56276316194928) , (15.629923908088585 , 46.5628186373834))
            line ((15.630060568857402 , 46.56278288337552) , (15.630135365686272 , 46.5629248325142))
            line ((15.629954765241848 , 46.562970687077154) , (15.629922048037514 , 46.56291098402386))
            line ((15.629258547992407 , 46.56308296579439) , (15.629271147057068 , 46.56310858947538))
            point ((15.629184313491862 , 46.56313108435387))
        }
    
        location "Trust kavarna" cafe 0.0 {
            set_spent "Trust kavarna" 27.80
            point ((15.629346907138597 , 46.56293052821118))
        }
    
        location "Trust club" club 0.0 {
            set_spent "Trust club" 350.10
            point ((15.62918958863358 , 46.563037489689094))
        }
        
        road "Gosposvetska cesta" {
            point ((15.62817514968151 , 46.563070334749455))
            point ((15.634334559854636 , 46.561562002602926))
        }
    
        location "Artur" bar 0.0 {
            set_spent "Artur" 1.90
            point ((15.628629826847174 , 46.563195927768845))
        }
    
        location "Fast Food pri Štuku" restaurant 0.0 {
            set_spent "Fast Food pri Štuku" 16.50
            point ((15.62775921695112 , 46.5635219201632))
            point ((15.627698988270168 , 46.563436029888095))
            point ((15.627939920165602 , 46.56335575998327))
            point ((15.627998791971066 , 46.56344068333098))
            point ((15.62775921695112 , 46.5635219201632))
        }
    
        road "Turnerjeva ulica" {
            point ((15.630119286464094 , 46.562593252966025))
            point ((15.630297290990711 , 46.562957245130264))
            point ((15.630535139228954 , 46.56333080954374))
            point ((15.630876180758435 , 46.56371195184866))
            point ((15.631122928691639 , 46.56393130172242))
            point ((15.631510500101427 , 46.5641676534664))
            point ((15.631965346863439 , 46.56443730456127))
        }
    
        road "Hermanova ulica" {
            point ((15.631030415739957 , 46.56385239464396))
            point ((15.630423918409605 , 46.564097724918156))
            point ((15.629762038854807 , 46.56424439307477))
            point ((15.629063509945468 , 46.564390809746754))
        }
    """.trimIndent()

    val code8 = """
    city "Maribor" {
        point ((1,2))
        road "Gosposvetska" {
            box ((1,2),(3,4))
            box ((1,2),(3,4))
        }
    }
    """.trimIndent()

    val code9 = """
        building "box" {
            box ((15.62857163132253 , 46.56327009050841) , (15.628493111378674 , 46.56311194118203))
        }
    """.trimIndent()

    val code10 = """
        location "cantante" restaurant 53.0 {
            point ((15.635680451463116 , 46.55934100859193))
        }

        location "Čili bar" bar 4.3 {
            point ((15.633774575962832 , 46.55945601644319))
        }

        location "kavarna stil burger" restaurant 4.0 {
            point ((15.635103847096559 , 46.559029275557094))
        }

        location "pizerija Pronto" restaurant 0.1 {
            point ((15.636226244908443 , 46.559250212746974))
        }

        location "Spar" shop 100.0 {
            point ((15.636127431643104 , 46.558991825687855))
        }

        location "Luciano" bar 10.0 {
            point ((15.637601954258173 , 46.55903419730262))
        }

        location "tropic cafe" bar 8.8 {
            point ((15.637927669701014 , 46.55982109270829))
        }

        building "Unnamed_1" {
            line ((15.633515282910508 , 46.55958819740749) , (15.633506930937557 , 46.55945381537788))
            line ((15.634731330104273 , 46.55941820982676) , (15.635097146499191 , 46.55934814722295))
            line ((15.635170643856043 , 46.559497460859944) , (15.635138906360936 , 46.55950664937768))
            line ((15.635182336617845 , 46.55960887153614) , (15.634983559672804 , 46.55964907120878))
            line ((15.634935118233301 , 46.55955029481723) , (15.634756386021564 , 46.55958819740749))
            line ((15.634534223552947 , 46.55958704884458) , (15.634550927498793 , 46.55969386509443))
            line ((15.634310390690587 , 46.5597064992607) , (15.634318742663481 , 46.55958934597035))
            line ((15.633939563111568 , 46.55960542584867) , (15.633959607846322 , 46.55971339062262))
            line ((15.633720741433308 , 46.55972028198411) , (15.633710719066642 , 46.55958704884458))
            line ((15.633515282910508 , 46.55958819740749) , (15.633515282910508 , 46.55958819740749))
        }
        
        building "Unnamed_2" {
            line ((15.634169884372398 , 46.558777493978425) , (15.634347325239162 , 46.558747613938664))
            line ((15.634347325239162 , 46.558747613938664) , (15.634457773125632 , 46.55902400367836))
            line ((15.634457773125632 , 46.55902400367836) , (15.635105975474573 , 46.5589131989519))
            line ((15.635105975474573 , 46.5589131989519) , (15.634995527588103 , 46.55863680921221))
            line ((15.634995527588103 , 46.55863680921221) , (15.634169884372398 , 46.558777493978425))
        }

        building "Unnamed_3" {
            line ((15.635625210505907 , 46.559493717166276) , (15.635554596266132 , 46.55925467953671))
            line ((15.635554596266132 , 46.55925467953671) , (15.63510983073963 , 46.5593280579387))
            line ((15.63510983073963 , 46.5593280579387) , (15.635180444979404 , 46.55956709556827))
            line ((15.635180444979404 , 46.55956709556827) , (15.635625210505907 , 46.559493717166276))
        }

        building "Unnamed_4" {
            line ((15.635415821838706 , 46.5584752068938) , (15.635606349707786 , 46.55843216086103))
            line ((15.635606349707786 , 46.55843216086103) , (15.63552148991824 , 46.55815072108287))
            line ((15.63552148991824 , 46.55815072108287) , (15.635330962049161 , 46.55819376711564))
            line ((15.635330962049161 , 46.55819376711564) , (15.635415821838706 , 46.5584752068938))
        }

        building "Unnamed_5" {
            line ((15.63641775324436 , 46.55925056562725) , (15.636380181659717 , 46.5591268005077))
            line ((15.636380181659717 , 46.5591268005077) , (15.636075138125636 , 46.5591792145506))
            line ((15.636075138125636 , 46.5591792145506) , (15.63611270971028 , 46.55930297967015))
            line ((15.63611270971028 , 46.55930297967015) , (15.63641775324436 , 46.55925056562725))
        }

        building "Unnamed_6" {
            line ((15.637609205089632 , 46.55931501820564) , (15.637766382955505 , 46.55928475691684))
            line ((15.637766382955505 , 46.55928475691684) , (15.63769900963638 , 46.55904383737159))
            line ((15.63769900963638 , 46.55904383737159) , (15.637541831770505 , 46.55907409866039))
            line ((15.637541831770505 , 46.55907409866039) , (15.637609205089632 , 46.55931501820564))
        }
        
        road "koroška cesta" {
            line ((15.632988132041959 , 46.55944545032824) , (15.633479880607496 , 46.559374884624816))
            line ((15.633479880607496 , 46.559374884624816) , (15.633833865603535 , 46.559321256990015))
            line ((15.633833865603535 , 46.559321256990015) , (15.634482067952476 , 46.55921045226356))
            line ((15.634482067952476 , 46.55921045226356) , (15.634847391843565 , 46.55915277994413))
            line ((15.634847391843565 , 46.55915277994413) , (15.635487254539445 , 46.55905014521786))
            line ((15.635487254539445 , 46.55905014521786) , (15.636015458221273 , 46.558961625134235))
            line ((15.636015458221273 , 46.558961625134235) , (15.636649998419562 , 46.55885489426018))
            line ((15.636649998419562 , 46.55885489426018) , (15.63698601518467 , 46.55879172679179))
            line ((15.63698601518467 , 46.55879172679179) , (15.637289793431806 , 46.55873606200926))
        }

        road "prežihova cesta" {
            line ((15.637773059387456 , 46.55891326505258) , (15.638102317122616 , 46.55984532091301))
        }

        road "smetanova ulica" {
            line ((15.640518299204246 , 46.559351362703495) , (15.633531193501454 , 46.56085380496103))
        }
    """.trimIndent()

    val lexer = Lexer(code9)
    val tokens = lexer.tokenize()
    var index = 0
    for (token in tokens) {
        println(index.toString() + " " + token)
        index++
    }

    val evaluator = Evaluator2(tokens)
    val featList = evaluator.program().values.toList()

    val geoJson = Features(featList).toGeoJson()
    println(geoJson)
}
